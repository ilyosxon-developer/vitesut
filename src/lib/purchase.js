import axios from "axios";

// API bazaviy URL
const API_BASE_URL = "https://crmapimilk.pythonanywhere.com/";

// Axios instance yaratish
const axiosInstance = axios.create({
  baseURL: API_BASE_URL,
  headers: {
    "Content-Type": "application/json",
  },
});

// Tokenni olish va har safar soâ€˜rovga qoâ€˜shish
axiosInstance.interceptors.request.use(
  (config) => {
    const token = localStorage.getItem("access_token");
    if (token) {
      config.headers.Authorization = `JWT ${token}`;
    }
    return config;
  },
  (error) => Promise.reject(error)
);

// ðŸ”¹  olish
export const fetchBirliklar = () => axiosInstance.get("purchases/");

export const fetchPurchaseOmbor = () => axiosInstance.get("omborlar/");

// ðŸ”¹ Yangi  qoâ€˜shish
export const createPurchase  = (name) =>
  axiosInstance.post("purchases/", { name });

// ðŸ”¹  oâ€˜chirish
export const deleteBirlik = (id) => axiosInstance.delete(`purchases/${id}/`);

// ðŸ”¹  tahrirlash
export const updateBirlik = (id, name) =>
  axiosInstance.patch(`purchases/${id}/`, { name });

export default axiosInstance;
